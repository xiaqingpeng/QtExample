cmake_minimum_required(VERSION 3.16)

project(QtEnterpriseTest VERSION 2.0.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# 查找Qt6组件
find_package(Qt6 REQUIRED COMPONENTS 
    Core 
    Widgets 
    Network 
    Concurrent
)

# 设置Qt6自动处理
set(CMAKE_AUTOMOC ON)

# 企业级核心框架
set(CORE_SOURCES
    src/Core/Application.cpp
    src/Core/ServiceManager.cpp
    src/Core/DependencyContainer.cpp
)

set(CORE_HEADERS
    src/Core/Application.h
    src/Core/ServiceManager.h
    src/Core/DependencyContainer.h
    src/Core/Application.inl
)

# 接口定义
set(INTERFACE_HEADERS
    src/Interfaces/INetworkService.h
    src/Interfaces/IAuthenticationService.h
)

# 服务实现
set(SERVICE_SOURCES
    src/Services/NetworkService.cpp
    src/Services/AuthenticationService.cpp
    src/Services/AnalyticsService.cpp
)

set(SERVICE_HEADERS
    src/Services/NetworkService.h
    src/Services/AuthenticationService.h
    src/Services/AnalyticsService.h
)

# 本地化
set(LOCALIZATION_SOURCES
    src/Localization/LocalizationManager.cpp
)

set(LOCALIZATION_HEADERS
    src/Localization/LocalizationManager.h
)

# 必要的现有文件
set(EXISTING_SOURCES
    styles/theme_manager.cpp
)

set(EXISTING_HEADERS
    styles/theme_manager.h
)

# 测试主程序
set(TEST_SOURCES
    test-enterprise.cpp
)

# 创建可执行文件
qt_add_executable(QtEnterpriseTest
    ${CORE_SOURCES}
    ${CORE_HEADERS}
    ${INTERFACE_HEADERS}
    ${SERVICE_SOURCES}
    ${SERVICE_HEADERS}
    ${LOCALIZATION_SOURCES}
    ${LOCALIZATION_HEADERS}
    ${EXISTING_SOURCES}
    ${EXISTING_HEADERS}
    ${TEST_SOURCES}
)

# 链接Qt6库
target_link_libraries(QtEnterpriseTest PRIVATE
    Qt6::Core
    Qt6::Widgets
    Qt6::Network
    Qt6::Concurrent
)

# 设置包含目录
target_include_directories(QtEnterpriseTest PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/src
    ${CMAKE_CURRENT_SOURCE_DIR}/src/Core
    ${CMAKE_CURRENT_SOURCE_DIR}/src/Interfaces
    ${CMAKE_CURRENT_SOURCE_DIR}/src/Services
    ${CMAKE_CURRENT_SOURCE_DIR}/src/Localization
)

# 企业级特性宏定义
target_compile_definitions(QtEnterpriseTest PRIVATE
    ENTERPRISE_EDITION
    APP_VERSION="${PROJECT_VERSION}"
    QT_DEPRECATED_WARNINGS
)

message(STATUS "Qt Enterprise Test Configuration:")
message(STATUS "  Version: ${PROJECT_VERSION}")
message(STATUS "  Build Type: ${CMAKE_BUILD_TYPE}")
message(STATUS "  Qt Version: ${Qt6_VERSION}")